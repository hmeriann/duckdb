# name: benchmark/realnest/aggr/array_agg
# description: Different list aggregate functions in one query
# group: [realnest]

name different_list_aggregates
group real_nest

require json

require httpfs

cache real_nest.duckdb

load benchmark/realnest/load.sql

run
SELECT 
  list_aggregate(tau_pt, 'array_agg', '|'),
  list_aggregate(tau_eta, 'array_agg', '|'),
  list_aggregate(jet_pt, 'array_agg', '|'),
  list_aggregate(jet_eta, 'array_agg', '|'),
  list_aggregate(muon_pt, 'array_agg', '|'),
  list_aggregate(muon_eta, 'array_agg', '|'),
  list_aggregate(el_pt, 'array_agg', '|'),
  list_aggregate(el_eta, 'array_agg', '|'),
  list_aggregate(ph_pt, 'array_agg', '|'),
  list_aggregate(ph_eta, 'array_agg', '|')  
FROM singleMu;